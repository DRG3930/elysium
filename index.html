<!DOCTYPE html>
<html>

<head>
    <title>Walmart Attack Synopsis</title>
    <style>
        /* Add smoother, easier-on-the-eye font */
        body {
            font-family: 'Arial', sans-serif;
        }

        p {
            font-family: 'Arial';
            text-align: left;
        }

        h1 {
            text-align: center;
            color: #1a1a2e;
            font-family: 'Georgia', serif;
            background: linear-gradient(to bottom, #fad7a3, #8dd2fa);
            padding: 10px;
            border-radius: 10px;
        }

        .h0 {
            text-align: center;
            color: #1a1a2e;
            font-family: 'Georgia', serif;
            background: linear-gradient(to bottom, #4745453f, #6a5858);
            padding: 10px;
            padding-left: 10px;
            border-radius: 12px;
        }

        h2 {
            text-align: center;
            color: #1a1a2e;
            font-family: 'Georgia', serif;
            background: linear-gradient(to bottom, #f0f0f0, #d9d9d9);
            padding: 10px;
            padding-left: 10px;
            border-radius: 12px;
        }

        .left-aligned-container {
            text-align: left;
            width: 50%;
            word-wrap: break-word;
            margin-left: auto;
            margin-right: auto;
        }

        .gned-img-container {
            text-align: center;
            margin: 20px 0;
        }

        .middle-aligned-iframe-div {
            text-align: center;
            margin: 20px;
            align-items: center;
        }
    </style>
</head>

<body>
    <div class="left-aligned-container">
        <h1>Walmart Attack Synopsis: A More Informed Review</h1>
        <p style="text-align: center;"><i>Author: Mason Dyess</i></p>

        <h2>Introduction</h2><br>
        <p>After taking a well-deserved break, during which I relaxed, indulged in good food, and got ample sleep while
            continuing my research, I now have a much clearer understanding of the Walmart attack. Knowing what I know
            now, I regret not being better informed during our meeting, as I could have provided more accurate details
            and insights to explain the events that took place and the technology used.</p>
        <p>Initially, I was highly stressed, had almost no sleep, and lacked the ability to research during the attack.
            Trying to understand what I was looking at, what the adversaries were doing, while also trying to defend
            multiple devices and comprehend the technology presented was challenging.</p>


        <div class="oh">In the normal hacking order - target found, get network</div>
        <div class="oh">get other devices and back door, use exploits for sudo and the rest is up yo you</div>

        <h2>Tools for Stealing Passwords</h2>
        <h2> Found on Personal Android Device</h2><br>

        <p>Several hacking tools were discovered on my Android phone, including:</p>
        <ul>
            <li><b>W0rm-GPT</b>: A hacking tool that uses AI to assist in writing viruses and malware, such as
                retrieving passwords from browsers.</li><br>
        </ul>

        <h3><b>Variants:</h3b>
                </p>
                <ul>
                    <li><b>WormGPT-AI/WormGPT</b><a href="https://github.com/WormGPT-AI/WormGPT?form=MG0AV3">
                            w0rm1-gpt1</a> </li><br>
                    <li><b>JuraSecurity/Worm-GPT</b><a href="https://imgur.com/a/7kB8elB">w0rm1-gpt2</a></li><br>
                    <li><b>CarbonComputers/Worm-GPT</b><a
                            href="https://github.com/CarbonComputers/Worm-GPT">w0rm1-gpt3</a></li><br>
                </ul>

                <div class="gned-img-container">
                    <img src="https://i.imgur.com/OoPEUXw.jpeg" alt="no" height="50%" width="50%">
                </div>



                <h2>Tools That Explain DOM Manipulation and MITM Attacks</h2><br>



                <p>The Burp Suite was likely used as it contains various tools that assist in attacks, such as
                    Man-In-The-Middle
                    (MITM) attacks, which could explain some of the incorrect images and data displayed on pages.</p>


                <h2>The Infamous XSS</h2>
                <p text-align: center>cross site scripting</p><br>


                <h3>Log Injection Remote Code Execution (RCE)</h3><br>
                <p>In a log injection attack, an attacker could insert malicious code into a log file in a way that
                    exploits
                    the system’s processing of those logs, leading to remote code execution (RCE). One way this could be
                    achieved is by injecting code that triggers a reverse shell. A reverse shell allows an attacker to
                    gain
                    unauthorized access to the victim’s system, effectively establishing control remotely. For more
                    information on this specific attack chain, see our log file injection remote code execution (RCE)
                    resource.</p>

                <h3>Log File Injection: Cross-Site Scripting</h3><br>
                <p>A log injection attack could be exploited using a Cross-Site Scripting (XSS) payload, enabling an
                    attacker to inject malicious JavaScript or HTML into the logs, which could later be executed by
                    anyone
                    viewing or interacting with those logs through a web interface. This type of attack occurs when a
                    system
                    inadequately sanitizes user input before logging it and when those logs are displayed in a way that
                    allows HTML or JavaScript to be rendered in a browser. For more information on this specific attack
                    chain, see our log file injection XSS resource.</p> </br>




                <h2 style="text-align: center;">Revoking My Comments on GH-OST and RSS Involvement</h2><br>
                <p>
                    The involvement of GH-OST and RSS now seems implausible. I initially thought they were decompiling
                    binaries from that repo using vanilla Linux.
                    They performed small modifications to numerous binary files, but in reality, I had a
                    misunderstanding.
                    I would not have known about <code>fileprocsctrl</code> or <code>file -C filename</code> if it
                    hadn't
                    been introduced by the attackers.
                    They performed these actions repeatedly, influencing my initial analysis.
                </p><br>


                <h2 style="text-align= center;">Stored XSS Definition</h2><br>
                <p>
                    Stored XSS, occurs when user supplied input is stored and then rendered within a web page. Typical
                    entry
                    points for stored XSS are message forums, blog comments, user profiles and username fields.
                    An attacker typically exploits this vulnerability by injecting XSS payloads on popular pages of a
                    site
                    or passing a link to a victim, tricking them into viewing the page that contains the stored XSS
                    payload.
                    The victim visits the page and the payload is executed client side by the victims web browser.
                    Stored
                    XSS is also known as persistent cross-site scripting or persistent XSS.
                </p><br>

                <h2 style="text-align: center;">Stored XSS Attack: Basic Example</h2><br>
                <p>The diagram below assumes the attacker has already discovered a stored cross-site scripting
                    vulnerability
                    on the target web application and has a way of tricking or ensuring the victim will visit the page
                    containing the stored payload.</p>

                <p><img src="https://www.aptive.co.uk/img/blog/xss/stored-xss-diagram-example.webp" attr="img"
                        height="60%" width="60%"></src>
                </p><br>
                <h2 style="text-align: center;">Stored XSS Attack Diagram</h2><br>
                <p>
                    Stored XSS requires user supplied input to be stored by the application (making it persistent) and
                    rendered within the page.
                    The following list identifies some typical locations where Stored XSS vulnerabilities exist:
                </p>
                <ul><strong>
                        <li>Message Forums</li><br>
                        <li>Blog Comments</li><br>
                        <li>Profile page information</li><br>
                        <li>Admin portals</li><br>
                    </strong>
                </ul>

                <p>Looking for a manual security assessment? See our Penetration Testing Services page for more details.
                </p><br>

                <h2 style="text-align: center;">Typical Attack Vectors for Stored XSS</h2><br>
                <p>
                    An attacker can execute JavaScript of their choosing on the victims machine, therefore XSS can be
                    used
                    to execute a number of security risks and / or be used in combination with other web vulnerabilities
                    to
                    exploit a higher severity security vulnerability.
                </p>
                <ul><strong>
                        <li>Redirecting the browser </li><br>
                        <li>Link Placement</li><br>
                        <li>Hooking browsers – beef (redirecting vulnerable browsers to exploits)</li><br>
                        <li>Cookie Theft / Session Hijacking</li><br>
                        <li>Key logging</li><br>
                        <li>Using XSS to steal CSRF tokens</li><br>
                        <li>Fake login forms</li><br>
                        <li>Abusing HTML 5</li><br>
                    </strong>
                </ul>


                <h3>If you got into a computer, how to get into the others</h3><br>

                <h2>Bluetooth Attacks</h2><br>
                <p>It's challenging to determine which Bluetooth RAT was used, but BlueBorne or a similar tool seems
                    likely.
                    Relevant resources:</p>
                <ul>
                    <li><b>Video on BlueBorne Attack</b>: <a href="https://youtu.be/Az-l90RCns8">YouTube Link</a></li>
                    <br>
                    <li><b>Code Repository</b>: <a
                            href="https://github.com/DRG3930/elysium/blueborne-master">Elysium/BlueBorne</a></li><br>
                    <li><b>BlueDucky for Android Devices</b>: <a
                            href="https://github.com/DRG3930/elysium/BlueDucky_main/BlueD">
                            Blue Ducky</a></li><br>
                    <li><b>Elysium/BlueDucky</b></bElysium><a
                            href="https://github.com/DRG3930/elysium/BlueDucky_main/BlueDucky-main">Elysium/BlueDucky</a>
                    </li><br>
                    </p>



                    <ho> Once youre able to get into a computer, you must have the right access....</ho>

                    <h2 style="text-align: center;">We call this privilege Escalation - becominging a system admin</h2>
                    <br>
                    <p>
                        (Linux) on example is provided here - Traitor, a tool for privilege escalation, was used and can
                        be found in my repository:
                        <a href="https://github.com/DRG3930/elysium/traitor_main">Elysium/Traitor</a>
                    <p> there are many ways to do this using any different tools and exploits and software which I wont
                        get into here</p>
                    </p>




                    <div class="ho"> youre in now what? In my case they took control and mirrored my phone <div
                            class="ho"></div>

                        <h2>iPhone and Mac Access</h2><br>
                        <p>I believe the iPhone control (and possibly MacBook control) stemmed from stealing my Apple
                            ID. If two Apple
                            devices use the same Apple ID, they can mirror each other, explaining the behavior I
                            observed on both
                            devices. Some potential consequences include:</p>
                        <ul>
                            <li><b>Shared Data</b>: Contacts, calendars, and app data are synchronized across devices.
                            </li><br>
                            <li><b>Photos and Videos</b>: Sync automatically if iCloud Photos is enabled.</li><br>
                            <li><b>Messages and Calls</b>: Received on both phones, leading to potential confusion.</li>
                            <br>
                            <li><b>Apps and Purchases</b>: Shared app data and purchases.</li><br>
                            <li><b>Find My iPhone</b>: Both devices appear in the Find My app.</li><br>
                        </ul>
                        <p>For security reasons, direct control features are limited. More direct control or remote
                            access requires
                            explicit setup through apps like AnyDesk or TeamViewer.</p>

                        <p>When using the same Apple ID across multiple devices, these features become available:</p>
                        <ul>
                            <li><b>Find My App</b>: Locate, lock, or erase Apple devices.</li><br>
                            <li><b>Handoff and Continuity</b>: Start tasks on one device and continue them on another.
                            </li><br>
                            <li><b>Messages and Calls</b>: Conversations stay in sync; calls can be made directly from
                                Mac.</li><br>
                            <li><b>iCloud Drive</b>: Securely store and access documents across devices.</li><br>
                            <li><b>Apple Ecosystem Integration</b>: Seamless integration with features like AirDrop,
                                Apple Pay, and
                                automated workflows.</li><br>
                        </ul>


                        <h2>How to mirror 2 iphones</h2><br>
                        <ol>
                            <li><strong>Create a Backup Image</strong>: Use backup software to create a system image of
                                your iOS
                                device. For iOS, tools like iMazing can help create a complete backup of your device,
                                including the
                                OS state.</li><br>
                            <li><strong>Transfer the Image to a Virtual Machine</strong>: Import this backup into a
                                virtual machine
                                like the ones provided by UTM for iOS. This process will allow you to emulate the
                                current state of
                                your iOS device within the VM.</li><br>
                            <li><strong>Use Same Apple ID</strong>: Sign both iPhones into the same Apple ID which
                                allows them to
                                share information, but this method is not ideal for master-slave control.</li><br>
                            <li><strong>Third-Party Apps</strong>: Utilize third-party apps for screen mirroring such as
                                ApowerMirror, as discussed earlier.</li><br>
                            <li><b> This setup lets you mirror the current state of one iPhone onto another and control
                                    them as if
                                    one is
                                    updating or manipulating the other. Tread lightly here, since emulating and
                                    mirroring devices
                                    can often
                                    push the boundaries of the OS security features.
                                    <a
                                        href="https://thegadgetbuyer.com/what-happens-if-two-iphones-have-the-same-apple-id/?form=MG0AV3">Source</a></b>
                            </li><br>
                        </ol>





                        <h2 style="text-align: center;">Revoking My Previous Comments on gh-ost and RSS having any
                            involvement</h2><br>
                        <p>
                            The involvement of GH-OST and RSS now seems implausible. I initially thought they were
                            decompiling
                            binaries from that repo using vanilla Linux.
                            They performed small modifications to numerous binary files, but in reality, I had a
                            misunderstanding.
                            I would not have known about <code>fileprocsctrl</code> or <code>file -C filename</code> if
                            it hadn't
                            been introduced by the attackers.
                            They performed these actions repeatedly, influencing my initial analysis.
                        </p>




                        <h2>While gh-ost may not be related to this attach there is another GHOST </h2>
                        <p style="text-align: center">GHOSTS was developed by Carnigie Melon and has the power to
                            achieve the insane thigns I saw</p><br>

                        <p>Developed by Carnegie Mellon University's Software Engineering Institute (SEI), the GHOSTS
                            Framework is
                            an open-source software framework designed for creating, deploying, and orchestrating
                            complex non-player
                            character (NPC) activity within training, exercises, simulations, and educational
                            environments.</p>

                        <p>Watch GHOSTS in action:
                        <p>
                        <p>Check out this quick three-minute introductory video on YouTube:</p>

                        <div class="middle-aligned-iframe-div">
                            <iframe style="align-items: center;" width="550" height="300"
                                src="https://www.youtube.com/embed/EkwK-cqwjjA" title="GHOSTS" frameborder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                        </div>

                        <p text-align="center">At its core, GHOSTS consists of a client and an API server. The client
                            runs on
                            simulated user devices (e.g., workstations), while the API server is managed centrally.
                            Clients simulate user activities based
                            on timelines and NPCs:</p>

                        <p text-align="center"><a href="https://github.com/cmu-sei/GHOSTS"> Ghosts repo</a></p>


                        <div>
                            <ul>
                                <li><b>Timelines</b>: Preconfigured scripts that define user behavior (tasks,
                                    operations, and
                                    durations).</li><br>
                                <li><b>NPCs</b>: Autonomous actors that simulate human-like interactions, working
                                    independently or in
                                    groups, and can be reprogrammed via the API.</li><br>
                            </ul>
                        </div>

                        <p text-align="center">This presentation covers the research and technology behind the GHOSTS
                            framework for
                            thinking about and
                            implementing realism in a simulation, training, or exercise event.
                        </p>
                        <div class="middle-aligned-iframe-div">
                            <iframe width="500" height="250" src="https://www.youtube.com/embed/Rc9QD3voSGA"
                                title="GHOSTS in the Machine: Orchestrating a Realistic Cybersecurity Exercise Battlefield"
                                frameborder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                referrerpolicy="strict-origin-when-cross-origin" position="center"
                                allowfullscreen></iframe>
                        </div>